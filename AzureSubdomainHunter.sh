#!/bin/bash
echo "this script made by lnlinh31!"

while read target; do
	echo "---------------------------------------------------------------------------------------------------------------------------"
	echo "---------------------------------------------------------------------------------------------------------------------------"
	echo "-----------------------------------------------------------******----------------------------------------------------------"
	echo "[+]--------------------------------------------Finding subdomain for - "$target"-------------------------------------------"
	echo "-----------------------------------------------------------******----------------------------------------------------------"
	echo "---------------------------------------------------------------------------------------------------------------------------"
	echo "---------------------------------------------------------------------------------------------------------------------------"
	echo "\n"
	./subfinder -d $target -o $target".txt"
	echo "[+]--------------------------------------------           Finding CNAME records              -----------------------------------------------------------!"
	python3 cname_finder.py $target".txt"
	echo "[+]--------------------------------------------          Checking for availability         -------------------------------------------------------------!"
	while read line; do 
	az network traffic-manager profile check-dns -n $line | grep 'true' >nul 2>&1 && (echo "$line -->  Can be taked" | sed -e :a -e 's/^.\{1,60\}$/-&/;ta')|| (echo "$line -->  Failed" | sed -e :a -e 's/^.\{1,60\}$/-&/;ta') ; 

	done < "cname."$target".txt"

done < list.txt
